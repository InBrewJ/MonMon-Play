@import play.mvc.Http.Request
@import helper._
@import viewModels._
@import org.pac4j.core.context.session._;
@(
    spogVm: Spog
)(
    implicit
    request: Http.Request,
    playSessionStore: SessionStore
)
@main("MonMonSPOG") {

@partials.header()
@partials.userDetails()
@partials.navbar()

<div class="w3-content" style="max-width: 1500px">
    <div class="w3-row">
        <div class="w3-half w3-padding w3-center">
            <div class="w3-card w3-padding w3-margin">
                <p>Next payday: <span id="next-payday-ddmmyyyy">@spogVm.getNextPayDate()</span></p>
                <p>That is, <span id="next-pay-days-from-now">@spogVm.getDaysUntilNextPayday()</span> days away</p>
                <p>Savings Slider</p>
                <div class="slidecontainer">
                    <input type="range" min="0" max="100" value="@spogVm.getPercentageIncomeAsSavings()" class="slider" id="savings-slider">
                </div>
                <p>
                    <span id="savings-slider-val">@spogVm.getPercentageIncomeAsSavings()</span>% of income as savings + payoff pcm
                </p>
                <p>
                    That is, <span id="savings-amount"></span> of £<span id="incoming-total">@spogVm.getIncomingTotal()</span>
                </p>
<!--                MWM-13 -->
<!--                This might work better as a standard POST form-->
<!--                The backend needs to find the next payday and add -->
<!--                a new outgoing on that day -->
<!--                    That outgoing will then be the basis for a savings plan-->
<!--                    Should this type of outgoing be _derived_ from Outgoing?-->
<!--                    Could this be some sort of Liskov Substitution thing?-->
                <a id="savings-slider-val-target" href="/plans/updateSavingsPayoffPercentage?percent=@spogVm.getPercentageIncomeAsSavings()" class="w3-button w3-round w3-grey">Update savings plan</a>
            </div>
            <div class="w3-card w3-padding w3-margin">
                <p><b> SPOG stands for 'Single Pane of Glass'</b></p>
                <hr>
                <p>
                    <b>
                        Left per day after outgoings in DEBIT: £@spogVm.getAdjustedLeftPerDay()
                    </b>
                </p>
                <p>Already paid out: £@spogVm.getCompletedOutgoings()</p>
                <p>Left to pay out: £@spogVm.getPendingOutgoings()</p>
                <hr>
                <p>
                    This month, there are @spogVm.getDaysBetweenPaydays() days between paydays
                </p>
                <hr>
                <p>
                    - <b>MAX per day available (between paydays) -> £@spogVm.getMaxPerDay() </b><br/>
                    - MAX per week available -> £@spogVm.getMaxPerWeek() <br/>
                    - MAX per month available -> £@spogVm.getSurplus()<br/>
                    - rent (with sharing) as % of wages -> @spogVm.getPercentageIncomeAsRent()% <br/>
                    - outgoings (with sharing) as % of wages -> @spogVm.getPercentageIncomeAsOutgoings()%
                </p>
                <hr>
                <p>
                    - monthly takehome -> £@spogVm.getIncomingTotal()  <br/>
                    - monthly outgoings (with sharing) -> £@spogVm.getOutgoingTotal()  <br/>
                </p>
                <hr>
                <p>
                     - yearly takehome -> £@spogVm.getYearlyTakehome()  <br/>
                     - yearly outgoings -> £@spogVm.getYearlyOutgoings()  <br/>
                     - yearly surplus (how much left to live on) -> £@spogVm.getYearlySurplus() <br/>

                </p>
            </div>
        </div>
        <div class="w3-half w3-padding">
            <div class="w3-card w3-padding w3-margin">
                <p><b>Account Overview</b></p>
                <ul>
                    @for((a, status) <- spogVm.getAccountStatusMap()) {
                    <li>@a.name (@{a.`type`})
                        <ul>
                            <li>
                                £@status.getAlreadyPaid() already gone out
                            </li>
                            <li>
                                £@status.getPending() still needed
                            </li>
                            <li>
                                £@status.getLatestBalance() available
                            </li>
                            <li>
                                <b>
                                    £@status.getAdjustedAvailable() is what you <i>actually</i> have left
                                </b>
                            </li>
                        </ul>
                        <hr>
                    </li>
                    }
                </ul>
            </div>
        </div>
    </div>
</div>

}