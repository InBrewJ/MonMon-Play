@import play.mvc.Http.Request
@import play.libs.Scala.asScala;
@import helper._
@(
accounts: Seq[Account],
outgoings: Seq[Outgoing],
outgoingTotal: Float,
outgoingForm: Form[Outgoing],
editing: Boolean
)(implicit request: Http.Request, messages: play.i18n.Messages)
@main("MonMon") {
<script
  type="text/javascript"
  src='@routes.Assets.at("javascripts/index.js")'
></script>

@partials.header()
@partials.navbar()

<div class="w3-content w3-center" style="max-width: 1500px">
  <div class="w3-row w3-padding">
    <div class="w3-card w3-padding">
      <div class="w3-half">
        <p><b> These are apparently your bank accounts:</b></p>
        <table class="w3-left-align w3-table w3-striped">
          <tr>
            <th>name</th>
            <th>type</th>
            <th></th> <!-- edit -->
            <th></th> <!-- archive -->
          </tr>
          @for(a <- accounts) {
            <tr>
                <td>@a.name</td>
                <td>@{a.`type`}</td>
              <td class="w3-center">
                <!-- <a href="/editAccount/@a.id">
                  <i class="fas fa-pen"></i>
                </a> -->
              </td>
              <td class="w3-center">
                <a href="/binAccount/@a.id">
                  <i class="fas fa-trash-alt"></i>
                </a>
              </td>
            </tr>
          }
        </table>
      </div>
      <div class="w3-half w3-padding-64">
        <form method="POST" action="@routes.AccountController.addAccount()">
          @helper.CSRF.formField
          <input placeholder="account name" type="text" name="name" />
          <br />
          <input placeholder="nickname" type="text" name="nickname" />
          <br />
          <select id="type" name="type">
            <option value="DEBIT">Debit</option>
            <option value="DEBIT_SHARED_BILLS">Bills only</option>
            <option value="CREDIT">Credit</option>
            <option value="SHORT_TERM_SAVINGS">Savings (short term)</option>
            <option value="LONG_TERM_SAVINGS">Savings (long term)</option>
          </select>
          <br /><br />
          <button>Add Account</button>
        </form>
      </div>
      <div class="w3-row">
        <a href="/accounts">My accounts</a>
      </div>
    </div>
  </div>


  <div class="w3-row w3-padding">
    <div class="w3-card w3-padding">
      <div class="w3-half">
        <p><b> These are apparently your outgoings:</b></p>
        <p id="total">Total: £@outgoingTotal</p>
        <table class="w3-left-align w3-table w3-striped">
          <tr>
            <th>Outgoing day</th>
            <th>name</th>
            <th>cost</th>
            <th>from account</th>
            <th></th>
            <th></th>
          </tr>
          @for(o <- outgoings) {
            <tr>
              <td class="w3-center">@o.outgoingDay</td>
              <td>@o.name</td>
              <td>£@o.cost</td>
              <td>@o.account.name (@{o.account.`type`})</td>
              <td class="w3-center">
                <a href="/editOutgoing/@o.id">
                  <i class="fas fa-pen"></i>
                </a>&nbsp;
              </td>
              <td class="w3-center">
                <a href="/binOutgoing/@o.id">
                  <i class="fas fa-trash-alt"></i>
                </a>
              </td>
            </tr>
          }
        </table>
      </div>


      <div class="w3-half w3-padding-64">
        <form method="POST" action='@{
                if (editing)
                    routes.OutgoingController.updateOutgoing(request.path().split("/")(2).toInt)
                else
                    routes.OutgoingController.addOutgoing()
            }'>
          @helper.CSRF.formField
          <input
                  placeholder="name"
                  type="text"
                  name="name"
                  value='@outgoingForm.field("name").value()'
          />
          <br />
          <input
                  placeholder="how much?"
                  type="number"
                  step="0.01"
                  name="cost"
                  value='@outgoingForm.field("cost").value()'
          />
          <br />
          <input
                  placeholder="what day?"
                  type="number"
                  name="outgoingDay"
                  value='@outgoingForm.field("outgoingDay").value()'
          />
          <br />
          <label for="fromAccount">From account: </label>
          <select id="fromAccount" name="account_id">
            @for(a <- accounts) {
              <option
                 @{
                  if(outgoingForm.field("account.id").value().getOrElse(0).toString == a.id.toString) "selected"
                 }
                value="@a.id">
                  @a.name (@{a.`type`})
              </option>
            }
          </select>
          @checkbox(outgoingForm("bill"), Symbol("_label") -> "Bills?")
          @checkbox(outgoingForm("rent"), Symbol("_label") -> "Rent?")
          @checkbox(outgoingForm("hiddenFromTotal"), Symbol("_label") -> "Scheduled savings payment?")
          <br /><br />
          <button>@{ if (editing) "Amend" else "Add"} Outgoing</button>
        </form>
      </div>
      <div class="w3-row">
        <a href="/outgoings">My outgoings</a>
      </div>
    </div>
  </div>
</div>

}
